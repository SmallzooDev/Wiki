---
title: ìŠ¤í”„ë§ ë¶€íŠ¸ ê´€ë ¨ ğŸŒ¿
summary: 
date: 2025-02-04 18:30:49 +0900
lastmod: 2025-03-30 19:54:03 +0900
tags: 
categories: 
description: 
showToc: true
tocOpen: true
---
## í† ë¹„ì˜ ìŠ¤í”„ë§
### ê´€ì‹¬ì‚¬
> "ëª¨ë“  ë³€ê²½ê³¼ ë°œì „ì€ í•œê°€ì§€ ê´€ì‹¬ì— ì§‘ì¤‘í•´ì„œ ì¼ì–´ë‚œë‹¤. ë¬¸ì œëŠ” ë‹¤ë§Œ ê·¸ì— ë”°ë¥¸ ë³€ê²½ì´ í•œê°€ì§€ ê´€ì‹¬ì— ì§‘ì¤‘í•´ ìˆì§€ ì•Šë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ë˜ì„œ ìš°ë¦¬ê°€ í•´ì•¼ í•  ì¼ì€, í•œê°€ì§€ ê´€ì‹¬ì´ í•œêµ°ë° ì§‘ì¤‘ë˜ê²Œ í•˜ëŠ” ê²ƒì´ë‹¤."


### ê´€ê³„
> ëª¨ë¸ë§ ì‹œì ì˜ ì˜¤ë¸Œì íŠ¸ ê°„ ê´€ê³„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, ëŸ°íƒ€ì„ ì˜¤ë¸Œì íŠ¸ ê´€ê³„ë¥¼ ê°–ëŠ” êµ¬ì¡°ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ”ê²ƒì€ "í´ë¼ì´ì–¸íŠ¸ì˜ ì±…ì„"ì´ë‹¤. í´ë¼ì´ì–¸íŠ¸ëŠ” ìê¸°ê°€ UserDaoë¥¼ ì‚¬ìš©í•´ì•¼ í•  ì…ì¥ì´ê¸°ì—, UserDaoì˜ ì„¸ë¶€ ì „ëµì´ë¼ê³ ë„ ë³¼ ìˆ˜ ìˆëŠ” êµ¬í˜„í´ë˜ìŠ¤ë¥¼ ì„ íƒí•˜ê³  ì„ íƒí•œ í´ë˜ìŠ¤ì˜ ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„±í•´ì„œ ì—°ê²°í•´ì¤„ ìˆ˜ ìˆë‹¤.

### OCP
> í´ë˜ìŠ¤ë‚˜ ëª¨ë“ˆì€ í™•ì¥ì—ëŠ” ì—´ë ¤ìˆì–´ì•¼ í•˜ê³ , ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆì–´ì•¼ í•œë‹¤.
- êµ¬í˜„ì²´ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ì‹ì˜ í™•ì¥ì„, ê¸°ì¡´ ë¡œì§ì˜ ìˆ˜ì • ì—†ì´ ê°€ëŠ¥í•œ êµ¬ì¡°
- ì¡°ê¸ˆ ë” ì¶”ìƒì ì¸ ê²ƒì— ì˜ì¡´í•˜ë©° ì±…ì„ì„ ë¶„ë¦¬í•¨ìœ¼ë¡œ ë‹¬ì„±

### ë†’ì€ ì‘ì§‘ë„, ë‚®ì€ ê²°í•©ë„
- ê´€ì‹¬ì‚¬ê°€ ê°™ì€ ê²ƒë“¤ì´ ì‘ì§‘í•´ ìˆëŠ”ê²ƒ,
- ì±…ì„ê³¼ ê´€ì‹¬ì‚¬ê°€ ë‹¤ë¥¸ ì˜¤ë¸Œì íŠ¸ ë˜ëŠ” ëª¨ë“ˆê³¼ëŠ” ë‚®ì€ ê²°í•©ã„´ë„.
> ê²°í•©ë„ë‘ í•˜ë‚˜ì˜ ì˜¤ë¸Œì íŠ¸ê°€ ë³€ê²½ì´ ì¼ì–´ë‚  ë•Œ ê´€ê³„ë¥¼ ë§ºê³  ìˆëŠ” ë‹¤ë¥¸ ì˜¤ë¸Œì íŠ¸ì—ê²Œ 'ë³€í™”ë¥¼ ìš”êµ¬í•˜ëŠ” ì •ë„'

### Strategy Pattern
> ìì‹ ì˜ ê¸°ëŠ¥ contextì—ì„œ, í•„ìš”ì— ë”°ë¼ ë³€ê²½ì´ í•„ìš”í•œ ì•Œê³ ë¦¬ì¦˜ì„ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ í†µì§¸ë¡œ ì™¸ë¶€ë¡œ ë¶„ë¦¬ì‹œí‚¤ê³ , ì´ë¥¼ êµ¬í˜„í•œ êµ¬ì²´ì ì¸ ì•Œê³ ë¦¬ì¦˜ í´ë˜ìŠ¤ë¥¼ í•„ìš”ì— ë”°ë¼ ë°”ê¿”ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ë””ìì¸ íŒ¨í„´.


### ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬
- ìŠ¤í”„ë§ì´ ì œì–´ê¶Œì„ ê°€ì§€ê³  ì§ì ‘ ë§Œë“¤ê³  ê´€ë¦¬í•˜ëŠ” ì˜¤ë¸Œì íŠ¸ : bean
- ë¹ˆì˜ ìƒì„±ê³¼ ê´€ê³„ì„¤ì • ê°™ì€ ì œì–´ë¥¼ ë‹´ë‹¹í•˜ëŠ” IoCì˜¤ë¸Œì íŠ¸ë¥¼ : beanFactory
- ì´ë¥¼ í™•ì¥í•œ application context (ioc ë°©ì‹ì˜ bean factory)


### í—·ê°ˆë¦¬ëŠ” IOC ìš©ì–´ ì •ë¦¬
- `bean` : iocë°©ì‹ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ì˜¤ë¸Œì íŠ¸
- `bean factory` : iocë¥¼ ë‹´ë‹¹í•˜ëŠ” í•µì‹¬ ì»¨í…Œì´ë„ˆ, ë¹ˆ ë“±ë¡, ìƒì„± ì¡°íšŒ, ë°˜í™˜ ê·¸ ì™¸ ë¶€ê°€ì ì¸ ë¹ˆ ê´€ë¦¬ ê¸°ëŠ¥, ë³´í†µ ì´ê±¸ í™•ì¥í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ì´ìš©
- `application context` : ë¹ˆ íŒ©í† ë¦¬ë¥¼ í™•ì¥í•œ ioc ì»¨í…Œì´ë„ˆ, ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê°ì¢… ë¶€ê°€ì„œë¹„ìŠ¤ ì¶”ê°€
- `configuration metadata` : iocë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë©”íƒ€ë°ì´í„°
- `container`, `ioc container` : ë¹ˆíŒ©í† ë¦¬ë‚˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì§€ì¹­

### DL(Dependency Lookup)ì´ í•„ìš”í•œ ê²½ìš°

1. **í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ ë¹ˆ ì‚¬ìš© ì‹œ**
    - í”„ë¡œí† íƒ€ì… ë¹ˆì€ ë§¤ë²ˆ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ê°€ í•„ìš”í•  ë•Œ ì‚¬ìš©ëœë‹¤.
    - DIë¡œëŠ” í•œ ë²ˆë§Œ ì£¼ì…ë˜ë¯€ë¡œ, ì—¬ëŸ¬ ë²ˆ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ê°€ í•„ìš”í•˜ë©´ ObjectProviderë‚˜ Providerë¥¼ í†µí•œ DLì´ í•„ìš”.
    
2. **ì„ íƒì  ì˜ì¡´ì„±(Optional Dependencies) ì²˜ë¦¬**
    - íŠ¹ì • ë¹ˆì´ ìˆì„ ìˆ˜ë„, ì—†ì„ ìˆ˜ë„ ìˆëŠ” ìƒí™©ì—ì„œ ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•´ì•¼ í•  ë•Œ
    
3. **ìˆœí™˜ ì˜ì¡´ì„± ë¬¸ì œ í•´ê²°**
    - ë‘ ë¹ˆì´ ì„œë¡œë¥¼ ì°¸ì¡°í•˜ëŠ” ìˆœí™˜ ì˜ì¡´ì„±ì´ ìˆì„ ë•Œ, DLì„ ì‚¬ìš©í•˜ì—¬ ì§€ì—° ë¡œë”©ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
4. **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì—ì„œ ë¹ˆì„ ì‚¬ìš©í•´ì•¼ í•  ë•Œ**
    - ìŠ¤í”„ë§ ê´€ë¦¬ ê°ì²´ê°€ ì•„ë‹Œ ì¼ë°˜ ê°ì²´ì—ì„œ ìŠ¤í”„ë§ ë¹ˆì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°
    
5. **ëŸ°íƒ€ì„ì— ë¹ˆ ì„ íƒì´ í•„ìš”í•œ ê²½ìš°**
    - ì‚¬ìš©ì ì…ë ¥ì´ë‚˜ ì„¤ì •ì— ë”°ë¼ ë‹¤ë¥¸ ë¹ˆì„ ì‚¬ìš©í•´ì•¼ í•  ë•Œ
    
6. **ì§€ì—° ì´ˆê¸°í™”(Lazy Initialization)ê°€ í•„ìš”í•  ë•Œ**
    - íŠ¹ì • ë¹ˆì˜ ì´ˆê¸°í™” ë¹„ìš©ì´ ë†’ê³ , ì‹¤ì œ ì‚¬ìš© ì‹œì ê¹Œì§€ ì´ˆê¸°í™”ë¥¼ ë¯¸ë£¨ê³  ì‹¶ì„ ë•Œ


### ë©”ì†Œë“œë¥¼ ì´ìš©í•œ ì˜ì¡´ê´€ê³„ ì£¼ì…
- `setter` ì£¼ì…
- ì¼ë°˜ ë©”ì†Œë“œ ì´ìš©í•œ ì£¼ì…

```java
@Bean
public UserDao userDao() {
	UserDao userDao = new UserDao();
	userDao.setConnectionMaker(connectionMaker());
	return userDao;
}
```

### í…œí”Œë¦¿
> ì´ ë¬¸ì œì˜ í•µì‹¬ì€ ë³€í•˜ì§€ ì•ŠëŠ”, ê·¸ëŸ¬ë‚˜ ë§ì€ ê³³ì—ì„œ ì¤‘ë³µë˜ëŠ” ì½”ë“œì™€ ë¡œì§ì— ë”°ë¼ ìê¾¸ í™•ì¥ë˜ê³  ìì£¼ ë³€í•˜ëŠ” ì½”ë“œë¥¼ ì˜ ë¶„ë¦¬í•´ë‚´ëŠ” ì‘ì—…ì´ë‹¤.

> ê²°êµ­ DIë€ ì´ëŸ¬í•œ ì „ëµ íŒ¨í„´ì˜ ì¥ì ì„ ì¼ë°˜ì ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆë„ë¡ ë§Œë“  êµ¬ì¡°ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.

> ìŠ¤í”„ë§ DIëŠ” ë„“ê²Œ ë³´ìë©´ ê°ì²´ì˜ ìƒì„±ê³¼ ê´€ê³„ ì„¤ì •ì— ëŒ€í•œ ì œì–´ê¶Œí•œì„ ì˜¤ë¸Œì íŠ¸ì—ì„œ ì œê±°í•˜ê³  ì™¸ë¶€ë¡œ ìœ„ì„í•œë‹¤.

```java
// 1. ì½œë°± ì¸í„°í˜ì´ìŠ¤ ì •ì˜
interface Callback {
    void execute();
}

// 2. í…œí”Œë¦¿ í´ë˜ìŠ¤ ì •ì˜
class Template {
    public void execute(Callback callback) {
        startOperation();        // ê³µí†µ ì‹œì‘ ì‘ì—…
        
        try {
            callback.execute();  // ì½œë°± ì‹¤í–‰ (ë³€í•˜ëŠ” ë¶€ë¶„)
        } catch (Exception e) {
            handleException(e);  // ì˜ˆì™¸ ì²˜ë¦¬
        } finally {
            endOperation();      // ê³µí†µ ì¢…ë£Œ ì‘ì—…
        }
    }
    
    private void startOperation() {
        System.out.println("ì‘ì—…ì„ ì‹œì‘í•©ë‹ˆë‹¤.");
        // ë¦¬ì†ŒìŠ¤ ì´ˆê¸°í™”, ì—°ê²° ì„¤ì • ë“±
    }
    
    private void handleException(Exception e) {
        System.out.println("ì˜ˆì™¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e.getMessage());
        // ë¡œê¹…, ë¡¤ë°± ë“±
    }
    
    private void endOperation() {
        System.out.println("ì‘ì—…ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
        // ë¦¬ì†ŒìŠ¤ ì •ë¦¬, ì—°ê²° ì¢…ë£Œ ë“±
    }
}

// 3. í…œí”Œë¦¿ ì½œë°± íŒ¨í„´ ì‚¬ìš© ì˜ˆì‹œ (íŒŒì¼ ì‘ì—…)
class FileProcessor {
    private final Template template;
    
    public FileProcessor() {
        this.template = new Template();
    }
    
    public void processFile(final String filePath) {
        template.execute(new Callback() {
            @Override
            public void execute() {
                System.out.println("íŒŒì¼ " + filePath + "ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.");
                // ì‹¤ì œ íŒŒì¼ ì²˜ë¦¬ ë¡œì§
            }
        });
    }
}

// 4. í…œí”Œë¦¿ ì½œë°± íŒ¨í„´ ì‚¬ìš© ì˜ˆì‹œ (ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…)
class DatabaseProcessor {
    private final Template template;
    
    public DatabaseProcessor() {
        this.template = new Template();
    }
    
    public void executeQuery(final String query) {
        template.execute(new Callback() {
            @Override
            public void execute() {
                System.out.println("ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤: " + query);
                // ì‹¤ì œ ì¿¼ë¦¬ ì‹¤í–‰ ë¡œì§
            }
        });
    }
}

// 5. ì œë„¤ë¦­ì„ í™œìš©í•œ í™•ì¥ ì˜ˆì‹œ
interface CallbackWithResult<T> {
    T execute();
}

class GenericTemplate {
    public <T> T executeWithResult(CallbackWithResult<T> callback) {
        startOperation();
        
        try {
            T result = callback.execute();  // ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ì½œë°± ì‹¤í–‰
            return result;
        } catch (Exception e) {
            handleException(e);
            return null;
        } finally {
            endOperation();
        }
    }
    
    private void startOperation() {
        System.out.println("ì‘ì—…ì„ ì‹œì‘í•©ë‹ˆë‹¤.");
    }
    
    private void handleException(Exception e) {
        System.out.println("ì˜ˆì™¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e.getMessage());
    }
    
    private void endOperation() {
        System.out.println("ì‘ì—…ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
    }
}

// ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ì œë„¤ë¦­ í…œí”Œë¦¿ ì‚¬ìš© ì˜ˆì‹œ
class ResultExample {
    public static void main(String[] args) {
        GenericTemplate template = new GenericTemplate();
        
        // ë¬¸ìì—´ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” í…œí”Œë¦¿ ì½œë°±
        String result = template.executeWithResult(() -> {
            return "ì‘ì—… ê²°ê³¼ì…ë‹ˆë‹¤.";
        });
        
        System.out.println("ë°˜í™˜ëœ ê²°ê³¼: " + result);
    }
}

public class TemplateCallbackPatternExample {
    public static void main(String[] args) {
        FileProcessor fileProcessor = new FileProcessor();
        fileProcessor.processFile("example.txt");
        
        DatabaseProcessor dbProcessor = new DatabaseProcessor();
        dbProcessor.executeQuery("SELECT * FROM users");
        
        ModernUsage.main(args);
        
        ResultExample.main(args);
    }
}
```


### ì˜ˆì™¸
> ì´ì „ì—ëŠ” ë³µêµ¬í•  ê°€ëŠ¥ì„±ì´ ì¡°ê¸ˆì´ë¼ë„ ìˆë‹¤ë©´ ì²´í¬ ì˜ˆì™¸ë¡œ ë§Œë“ ë‹¤ê³  ìƒê°í–ˆëŠ”ë°, ì§€ê¸ˆì€ í•­ìƒ ë³µêµ¬í•  ìˆ˜ ìˆëŠ” ì˜ˆì™¸ê°€ ì•„ë‹ˆë¼ë©´ ì¼ë‹¨ ì–¸ì²´í¬ ì˜ˆì™¸ë¡œ ë§Œë“œëŠ” ê²½í–¥ì´ ìˆë‹¤.

`Checked Exception` : 
- ì•ˆì¡ì„ìˆ˜ ì—†ìŒ
`Unchecked Exception` :
- ì˜ˆì™¸ê°€ í˜¸ì¶œ ìŠ¤íƒì„ ë”°ë¼ ìƒìœ„ë¡œ ì „íŒŒëœë‹¤.
- ì–´ë–¤ ë©”ì„œë“œì—ì„œë„ ì²˜ë¦¬ë˜ì§€ ì•Šìœ¼ë©´ JVMê¹Œì§€ ì „ë‹¬ëœë‹¤.
- JVMì´ ì˜ˆì™¸ ì •ë³´ë¥¼ í‘œì¤€ ì˜¤ë¥˜ ìŠ¤íŠ¸ë¦¼ì— ì¶œë ¥í•œë‹¤.
- í•´ë‹¹ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œëœë‹¤.
- ë©”ì¸ ìŠ¤ë ˆë“œì˜€ë‹¤ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ê°€ ì¢…ë£Œëœë‹¤.


### ë¹„í‘œì¤€ SQL
> ë‹¤ì–‘í•œ dbë¥¼ ì“¸ ìˆ˜ ìˆë„ë¡ ìœ ì—°í•˜ê²Œ í•˜ê¸°ìœ„í•œ jdbcì˜ ë…¸ë ¥
- ë‘ê°€ì§€ ì´ìŠˆê°€ ìˆìŒ
	- ë¹„í‘œì¤€ sql -> db ê³ ìœ ì˜ ë¬¸ë²•ê³¼ ë°©ì–¸
	- ê°ê° ë‹¤ë¥¸ ì—ëŸ¬ì½”ë“œ
- ì—ëŸ¬ì½”ë“œ ê´€ë ¨í•´ì„œëŠ” ì¼ë‹¨ êµ¬í˜„ì²´ëŠ” ë§Œë“¤ê¸° ì‰½ê³  ê±°ì˜  ìˆìŒ
	- ê¸°ë³¸ -> ì•½ê°„ì˜ ìƒíƒœê°’ì„ ê°€ì§„ `SQLException` 
		- `SQLException`ì€ ì‚¬ì‹¤ìƒ ë³µêµ¬ ë¶ˆëŠ¥
		- checkedë¡œ ë˜ì§ˆ ì´ìœ ê°€ ì—†ì–´ì„œ jdbcê°€ ë°”ê¿”ì„œ ë˜ì ¸ì¤Œ
	- `DataAccessException` : ì—„ì²­ ìƒì„¸í•œ ì„œë¸Œí´ë˜ìŠ¤ë¥¼ ì œê³µ
		- `BadSqlGrammarException`, `DataIntegrityViolationException`,`DuplicatedException`
		- ê·¼ë° ë¬¸ì œëŠ” dbë§ˆë‹¤ ì—ëŸ¬ì½”ë“œ ìì²´ê°€ ë‹¤ë¦„

### Transaction ë™ê¸°í™”
- jdbcì˜ ì˜ˆì‹œì—ì„œ íŠ¸ëœì­ì…˜ì˜ ê²½ê³„ì„¤ì •ì´ í•„ìš”í•œ ê²½ìš° : 
	- ì»¤ë„¥ì…˜ì´ í•„ìš”í•¨
		- ì»¤ë„¥ì…˜ì— AutoCommitì„ falseë¡œ ì„¤ì •í•˜ëŠ” ì„¤ì •ì„ ì§„í–‰
		- ì´í›„ commit(), rollback()ì˜ íŠ¸ëœì­ì…˜ ì¢…ë£Œë¥¼ ëª…ì‹œì ìœ¼ë¡œ ìˆ˜í–‰í•´ì¤˜ì•¼í•¨
	- ê·¸ ì»¤ë„¥ì…˜ì„ ì—¬ê¸°ì €ê¸° ê³„ì¸µì— ì „ë‹¬ì‹œì¼œì•¼í•¨ (ë©”ì„œë“œ íŒŒë¼ë¯¸í„° ì§€ì €ë¶„í•´ì§, ì»¤ë„¥ì…˜ì„ ì„œë¹„ìŠ¤ì—ì„œ ì—¬ê¸°ì €ê¸° ì „ë‹¬í•´ì¤˜ì•¼í•¨, ê·¸ë¦¬ê³  daoê°€ ì „ë‹¬ë°›ì€ ì»¤ë„¥ì…˜ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤ëŠ”ê²ƒì€ dao, serviceì—ì„œ íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•œ ì¢…ì†ì„ ì•¼ê¸°)
- ë‹¹ì¥ `JTA (Java Transaction API)`, `Hibernate`, `JDBC`ë“± ë‹¤ì–‘í•œ ì¸í„°í˜ì´ìŠ¤ê°€ ìˆëŠ”ë° íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´ì„±ì´ ìƒê¸°ëŠ” ìƒí™©ì„ ë§‰ê¸° ìœ„í•´ íŠ¸ëœì­ì…˜ì„ ì¶”ìƒí™”í•œë‹¤.
- ê¸°ë³¸ì ìœ¼ë¡œ
	- ì»¤ë„¥ì…˜ì„ ì €ì¥í•˜ëŠ” ì €ì¥ì†Œë¥¼ í†µí•´ì„œ ë™ê¸°í™”
	- íŠ¸ëœì­ì…˜ ê²½ê³„ ì„¤ì • ë“± ê´€ë ¨í•œ ê³µí†µ ì„±ì§ˆì„ ì¸í„°í˜ì´ìŠ¤ë¡œ ì¶”ìƒí™” í•´ë’€ìŒ : `PlatformTransactionManager`
	- ì´ ì¸í„°í˜ì´ìŠ¤ì˜ ì ì ˆí•œ êµ¬í˜„ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ íŠ¸ëœì­ì…˜ì„ ì´ìš©í•  ìˆ˜ ìˆìŒ ì˜ˆë¥¼ë“¤ì–´ JTAê°€ í•„ìš”í•˜ë‹¤ë©´ `JTATransactionManager`, `JPATransactionManager` ë“±
	- ë‹¹ì—°íˆ êµ¬í˜„ì²´ë¥¼ ì§ì ‘ ì“°ëŠ”ê±´ ì•„ì‰¬ìš´ ì„ íƒì´ë‹ˆê¹Œ DIë¥¼ ê³ ë ¤í•˜ê²Œ ë˜ëŠ”ë°, `PlatformTransactionManager`ëŠ” ì‹±ê¸€í†¤ìœ¼ë¡œ ì‚¬ìš©í•´ë„ ì•ˆì „í•¨

- ì´ë¶€ë¶„ì€ ë‚˜ë„ ì˜ˆì „ì— rustë¡œ í”„ë¡œì íŠ¸ë¥¼ í–ˆì„ ë•Œ, ì—„ì²­ ê³ ë¯¼ì„ ë§ì´í–ˆë˜ ë¶€ë¶„ì¸ë° ë­”ê°€ í™•ì‹¤íˆ ìŠ¤í”„ë§ì€ í•´ì£¼ëŠ”ê²Œ ë§ë‹¤ëŠ”ê±¸ ë‹¤ì‹œ ëŠê¼ˆë‹¤.
- ì—¬ê¸°ì²˜ëŸ¼ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ì§ì ‘ êµ¬í˜„í•´ì„œ
```rust
use sqlx::{Pool, Postgres, Transaction};
use std::sync::Arc;
use crate::error::db_error::DbError;

#[derive(Clone)]
pub struct TransactionManager {
    pool: Arc<Pool<Postgres>>,
}

impl TransactionManager {
    pub fn new(pool: Pool<Postgres>) -> Self {
        Self {
            pool: Arc::new(pool),
        }
    }

    pub async fn begin_tx(&self) -> Result<Transaction<'static, Postgres>, DbError> {
        self.pool
            .begin()
            .await
            .map_err(|e| DbError::SomethingWentWrong(e.to_string()))
    }
} 
```

- ì„œë¹„ìŠ¤ì—ì„œ ì£¼ì…ë°›ê³ 
```rust
#[derive(Clone)]
pub struct UserTicketService {
    tx_manager: Arc<TransactionManager>,
    user_ticket_repo: Arc<dyn UserTicketRepositoryTrait>,
}
```

- ì•„ë˜ì²˜ëŸ¼ ì‚¬ìš©í–ˆì—ˆë‹¤.
```rust
    pub async fn create_tickets_for_users(
        &self,
        user_ids: Vec<i32>,
    ) -> Result<Vec<TicketCreationResult>, ApiError> {
        let mut tx = self
            .tx_manager
            .begin_tx()
            .await
            .map_err(ApiError::Db)?;

        let mut results = Vec::new();

        for user_id in user_ids {
            let ticket_result = self
                .user_ticket_repo
                .create_ticket_in_tx(&mut tx, user_id)
                .await
                .map_err(|e| ApiError::Db(DbError::SomethingWentWrong(e.to_string())))?;

            results.push(ticket_result);
        }

        tx.commit()
            .await
            .map_err(|e| ApiError::Db(DbError::SomethingWentWrong(e.to_string())))?;

        Ok(results)
    }
```

- ë‹¹ì‹œì—ë„ ì´ ì±…ì—ì„œ ì½ì€ ë‚´ìš©ì´ ìƒê°ë‚˜ì„œ ë¹„ìŠ·í•˜ê²Œ ë”°ë¼í•´ë³¸ ê²ƒ ë„ ìˆì§€ë§Œ, ìŠ¤í”„ë§ íŠ¹ìœ ì˜ diì§‘ì°©ì´ ì§€ê¸ˆìƒê°í•˜ë©´ ì¢‹ì€ ìŠµê´€ì²˜ëŸ¼ ë‚¨ì•„ìˆê²Œë˜ì–´ ì´ëŸ¬í•œ ë¶€ë¶„ì„ ì¸ì§€ì‹œì¼œì£¼ë‚˜ ì‹¶ê¸´ í•˜ë‹¤.
- ì‹¤ì œë¡œë„ ì±…ì„ ë‹¤ì‹œ ì½ìœ¼ë©´ì„œ ì•„ë˜ì™€ ê°™ì€ ë¬¸ì¥ì„ ë‹¤ì‹œ ë³´ë‹ˆê¹Œ ê·¸ëƒ¥ ìƒê°ë‚˜ì„œ ì£¼ì €ë¦¬ í•œ ì´ì•¼ê¸°
> ê°ì²´ì§€í–¥ ê¸°ìˆ ì´ë‚˜ íŒ¨í„´ì„ ìµíˆê³  ì ìš©í•˜ëŠ”ì¼ì´ ì–´ë µê³  ì§€ë£¨í•˜ê²Œ ëŠê»´ì§„ë‹¤ë©´, ìŠ¤í”„ë§ì—ì„œ DIê°€ ì–´ë–»ê²Œ ì ìš©ë˜ê³  ìˆëŠ”ì§€ë¥¼ ì‚´í´ë³´ë©´ì„œ ì´ë¥¼ ë”°ë¼í•´ë³´ëŠ”ê²ƒë„ ì¢‹ì€ ë°©ë²•ì´ë‹¤. ê·¸ëŸ¬ë©´ì„œ ì¢‹ì€ ì½”ë“œì˜ íŠ¹ì§•ì´ ë¬´ì—‡ì´ê³ , ê°€ì¹˜ê°€ ìˆëŠ”ì§€ ì‚´í´ë³´ëŠ” ê²ƒì´ë‹¤.
> (ì¤‘ëµ)
> ìŠ¤í”„ë§ì„ ì—´ì‹¬íˆ ì‚¬ìš©í•˜ë‹¤ë³´ë©´, ì–´ëŠ ë‚  ìì‹ ì´ ë§Œë“  ì½”ë“œì— ê°ì²´ì§€í–¥ ì›ì¹™ê³¼ ë””ìì¸ íŒ¨í„´ì˜ ì¥ì ì´ ì˜ ë…¹ì•„ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ë°œê²¬í•˜ê²Œ ë  ê²ƒ ì´ë‹¤. ê·¸ê²ƒì´ ìŠ¤í”„ë§ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì–»ì„ ìˆ˜ ìˆëŠ” ê°€ì¥ í° ì¥ì ì´ë‹¤.


> ì¼ë°˜ì ìœ¼ë¡œ ì„œë¹„ìŠ¤ ì¶”ìƒí™”ë¼ê³  í•˜ë©´ íŠ¸ëœì­ì…˜ê³¼ ê°™ì´ ê¸°ëŠ¥ì€ ìœ ì‚¬í•˜ë‚˜ ì‚¬ìš© ë°©ë²•ì´ ë‹¤ë¥¸ ë¡œìš°ë ˆë²¨ì˜ ë‹¤ì–‘í•œ ê¸°ìˆ ì— ëŒ€í•´ ì¶”ìƒ ì¸í„°í˜ì´ìŠ¤ì™€ ì¼ê´€ì„± ìˆëŠ” ì ‘ê·¼ ë°©ë²•ì„ ì œê³µí•´ì£¼ëŠ” ê²ƒì„ ë§í•œë‹¤. ë°˜ë©´ MailServiceì™€ ê°™ì´ í…ŒìŠ¤íŠ¸ë¥¼ ì–´ë µê²Œ ë§Œë“œëŠ” ê±´ì „í•˜ì§€ ì•Šì€ ë°©ì‹ìœ¼ë¡œ ì„¤ê³„ëœ APIë¥¼ ì‚¬ìš©í•  ë•Œë„ ìœ ìš©í•˜ê²Œ ì“°ì¼ ìˆ˜ ìˆë‹¤.


### Dynamic Proxyì™€ Proxy Bean

> í”„ë¡ì‹œì˜ íŠ¹ì§•ì€ íƒ€ê¹ƒê³¼ ê°™ì€ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í–ˆë‹¤ëŠ” ê²ƒê³¼ í”„ë¡ì‹œê°€ íƒ€ê¹ƒì„ ì œì–´í•  ìˆ˜ ìˆëŠ” ìœ„ì¹˜ì— ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.

> ë°ì½”ë ˆì´í„° íŒ¨í„´ì€ íƒ€ê¹ƒì— ë¶€ê°€ì ì¸ ê¸°ëŠ¥ì„ ëŸ°íƒ€ì„ì— ë‹¤ì´ë‚˜ë¯¹í•˜ê²Œ ë¶€ì—¬í•´ì£¼ê¸° ìœ„í•´ í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´ì„ ë§í•œë‹¤.

> í”„ë¡ì‹œë¡œì„œ ë™ì‘í•˜ëŠ” ê° ë°ì½”ë ˆì´í„°ëŠ” ìœ„ì„í•˜ëŠ” ëŒ€ìƒì—ë„ ì¸í„°í˜ì´ìŠ¤ë¡œ ì ‘ê·¼í•˜ê¸° ë•Œë¬¸ì— ìì‹ ì´ ìµœì¢… íƒ€ê¹ƒìœ¼ë¡œ ìœ„ì„í•˜ëŠ”ì§€, ì•„ë‹ˆë©´ ë‹¤ìŒ ë‹¨ê³„ì˜ ë°ì½”ë ˆì´í„° í”„ë¡ì‹œë¡œ ìœ„ì„í•˜ëŠ”ì§€ ì•Œì§€ ëª»í•œë‹¤. ê·¸ë˜ì„œ ë°ì½”ë ˆì´í„°ì˜ ë‹¤ìŒ ìœ„ì„ ëŒ€ìƒì€ ì¸í„°í˜ì´ìŠ¤ë¡œ ì„ ì–¸í•˜ê³  ìƒì„±ìë‚˜ ìˆ˜ì •ì ë©”ì†Œë“œë¥¼ í†µí•´ ìœ„ì„ ëŒ€ìƒì„ ìœ„ë¶€ì—ì„œ ëŸ°íƒ€ì„ ì‹œì— ì£¼ì…ë°›ì„ ìˆ˜ ìˆë„ë¡ ë§Œë“¤ì–´ì•¼ í•œë‹¤.


```java
// 1. ì»´í¬ë„ŒíŠ¸ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
interface DataSource {
    String read();
    void write(String data);
}

// 2. êµ¬ì²´ì ì¸ ì»´í¬ë„ŒíŠ¸ - ê¸°ë³¸ ë°ì´í„° ì†ŒìŠ¤
class FileDataSource implements DataSource {
    private String fileName;
    
    public FileDataSource(String fileName) {
        this.fileName = fileName;
    }
    
    @Override
    public String read() {
        System.out.println("ê¸°ë³¸ ë°ì´í„° ì½ê¸°: " + fileName);
        return "ì›ë³¸ ë°ì´í„°";
    }
    
    @Override
    public void write(String data) {
        System.out.println("ê¸°ë³¸ ë°ì´í„° ì“°ê¸°: " + data + " to " + fileName);
    }
}

// 3. ì•”í˜¸í™” ë°ì½”ë ˆì´í„°
class EncryptionDecorator implements DataSource {
    private DataSource wrappee;
    
    public EncryptionDecorator(DataSource source) {
        this.wrappee = source;
    }
    
    @Override
    public String read() {
        System.out.println("ì•”í˜¸í™” ë°ì½”ë ˆì´í„°: read() í˜¸ì¶œ ì „");
        
        // wrappeeê°€ ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸ì¸ì§€ ë‹¤ë¥¸ ë°ì½”ë ˆì´í„°ì¸ì§€ ì•Œ ìˆ˜ ì—†ìŒ
        String data = wrappee.read();
        
        System.out.println("ì•”í˜¸í™” ë°ì½”ë ˆì´í„°: wrappee.read() ë°˜í™˜ ê°’: " + data);
        String decrypted = decrypt(data);
        System.out.println("ì•”í˜¸í™” ë°ì½”ë ˆì´í„°: ë³µí˜¸í™” ê²°ê³¼: " + decrypted);
        
        return decrypted;
    }
    
    @Override
    public void write(String data) {
        System.out.println("ì•”í˜¸í™” ë°ì½”ë ˆì´í„°: write() í˜¸ì¶œë¨, ë°ì´í„°: " + data);
        
        String encrypted = encrypt(data);
        System.out.println("ì•”í˜¸í™” ë°ì½”ë ˆì´í„°: ì•”í˜¸í™” ê²°ê³¼: " + encrypted);
        
        // wrappeeê°€ ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸ì¸ì§€ ë‹¤ë¥¸ ë°ì½”ë ˆì´í„°ì¸ì§€ ì•Œ ìˆ˜ ì—†ìŒ
        wrappee.write(encrypted);
        
        System.out.println("ì•”í˜¸í™” ë°ì½”ë ˆì´í„°: wrappee.write() ì™„ë£Œ");
    }
    
    private String encrypt(String data) {
        return "ì•”í˜¸í™”[" + data + "]";
    }
    
    private String decrypt(String data) {
        if (data.contains("ì•”í˜¸í™”")) {
            return data.replace("ì•”í˜¸í™”[", "").replace("]", "");
        }
        return "ë³µí˜¸í™”[" + data + "]";
    }
}

// 4. ì••ì¶• ë°ì½”ë ˆì´í„°
class CompressionDecorator implements DataSource {
    private DataSource wrappee;
    
    public CompressionDecorator(DataSource source) {
        this.wrappee = source;
    }
    
    @Override
    public String read() {
        System.out.println("ì••ì¶• ë°ì½”ë ˆì´í„°: read() í˜¸ì¶œ ì „");
        
        // wrappeeê°€ ì²´ì¸ì˜ ë§ˆì§€ë§‰ì¸ì§€ ì•Œ ìˆ˜ ì—†ìŒ
        String data = wrappee.read();
        
        System.out.println("ì••ì¶• ë°ì½”ë ˆì´í„°: wrappee.read() ë°˜í™˜ ê°’: " + data);
        String decompressed = decompress(data);
        System.out.println("ì••ì¶• ë°ì½”ë ˆì´í„°: ì••ì¶•í•´ì œ ê²°ê³¼: " + decompressed);
        
        return decompressed;
    }
    
    @Override
    public void write(String data) {
        System.out.println("ì••ì¶• ë°ì½”ë ˆì´í„°: write() í˜¸ì¶œë¨, ë°ì´í„°: " + data);
        
        String compressed = compress(data);
        System.out.println("ì••ì¶• ë°ì½”ë ˆì´í„°: ì••ì¶• ê²°ê³¼: " + compressed);
        
        // wrappeeê°€ ì²´ì¸ì˜ ë§ˆì§€ë§‰ì¸ì§€ ì•Œ ìˆ˜ ì—†ìŒ
        wrappee.write(compressed);
        
        System.out.println("ì••ì¶• ë°ì½”ë ˆì´í„°: wrappee.write() ì™„ë£Œ");
    }
    
    private String compress(String data) {
        return "ì••ì¶•[" + data + "]";
    }
    
    private String decompress(String data) {
        if (data.contains("ì••ì¶•")) {
            return data.replace("ì••ì¶•[", "").replace("]", "");
        }
        return "ì••ì¶•í•´ì œ[" + data + "]";
    }
}

// 5. ë¡œê¹… ë°ì½”ë ˆì´í„°
class LoggingDecorator implements DataSource {
    private DataSource wrappee;
    
    public LoggingDecorator(DataSource source) {
        this.wrappee = source;
    }
    
    @Override
    public String read() {
        System.out.println("ë¡œê¹… ë°ì½”ë ˆì´í„°: read() í˜¸ì¶œ ì „");
        
        String result = wrappee.read();
        
        System.out.println("ë¡œê¹… ë°ì½”ë ˆì´í„°: wrappee.read() ë°˜í™˜ ê°’: " + result);
        return result;
    }
    
    @Override
    public void write(String data) {
        System.out.println("ë¡œê¹… ë°ì½”ë ˆì´í„°: write() í˜¸ì¶œë¨, ë°ì´í„°: " + data);
        
        wrappee.write(data);
        
        System.out.println("ë¡œê¹… ë°ì½”ë ˆì´í„°: wrappee.write() ì™„ë£Œ");
    }
}

// 6. í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ
public class DecoratorPatternDemo {
    public static void main(String[] args) {
        // ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸
        System.out.println("=== ë°ì½”ë ˆì´í„° ì²´ì¸ ìƒì„± ì‹œì‘ ===");
        DataSource source = new FileDataSource("data.txt");
        System.out.println("ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸ ìƒì„±: FileDataSource");
        
        // ì•”í˜¸í™” ë°ì½”ë ˆì´í„°ë¡œ ê°ì‹¸ê¸°
        source = new EncryptionDecorator(source);
        System.out.println("1ë²ˆì§¸ ë°ì½”ë ˆì´í„° ì¶”ê°€: EncryptionDecorator");
        
        // ì••ì¶• ë°ì½”ë ˆì´í„°ë¡œ ê°ì‹¸ê¸°
        source = new CompressionDecorator(source);
        System.out.println("2ë²ˆì§¸ ë°ì½”ë ˆì´í„° ì¶”ê°€: CompressionDecorator");
        
        // ë¡œê¹… ë°ì½”ë ˆì´í„°ë¡œ ê°ì‹¸ê¸°
        source = new LoggingDecorator(source);
        System.out.println("3ë²ˆì§¸ ë°ì½”ë ˆì´í„° ì¶”ê°€: LoggingDecorator");
        
        // ë°ì´í„° ì“°ê¸° - ì—°ì‡„ì  í˜¸ì¶œ ì‹œì‘
        System.out.println("\n=== ë°ì´í„° ì“°ê¸° ì—°ì‡„ í˜¸ì¶œ ì‹œì‘ ===");
        source.write("í…ŒìŠ¤íŠ¸ ë°ì´í„°");
        System.out.println("=== ë°ì´í„° ì“°ê¸° ì—°ì‡„ í˜¸ì¶œ ì™„ë£Œ ===\n");
        
        // ë°ì´í„° ì½ê¸° - ì—°ì‡„ì  í˜¸ì¶œ ì‹œì‘
        System.out.println("\n=== ë°ì´í„° ì½ê¸° ì—°ì‡„ í˜¸ì¶œ ì‹œì‘ ===");
        String result = source.read();
        System.out.println("=== ë°ì´í„° ì½ê¸° ì—°ì‡„ í˜¸ì¶œ ì™„ë£Œ ===");
        System.out.println("ìµœì¢… ê²°ê³¼: " + result);
    }
}
```

> ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í”„ë¡ì‹œë¼ëŠ” ìš©ì–´ì™€ ë””ìì¸ íŒ¨í„´ì—ì„œ ë§í•˜ëŠ” í”„ë¡ì‹œ íŒ¨í„´ì€ êµ¬ë¶„í•  í•„ìš”ê°€ ìˆë‹¤.
> ì „ìëŠ” í´ë¼ì´ì–¸íŠ¸ì™€ ì‚¬ìš© ëŒ€ìƒ ì‚¬ì´ì— ëŒ€ë¦¬ ì—­í• ì„ ë§¡ì€ ì˜¤ë¸Œì íŠ¸ë¥¼ ë‘ëŠ” ë°©ë²•ì„ ì´ì¹­í•œë‹¤ë©´, 
> 
> í›„ìëŠ” í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì¤‘ì—ì„œ íƒ€ê¹ƒì— ëŒ€í•œ ì ‘ê·¼ë°©ë²•ì„ ì œì–´í•˜ë ¤ëŠ” ëª©ì ì„ ê°€ì§„ ê²½ìš°ë¥¼ ê°€ë¦¬í‚¨ë‹¤.

> í”„ë¡ì‹œ íŒ¨í„´ì˜ í”„ë¡ì‹œëŠ” íƒ€ê¹ƒì˜ ê¸°ëŠ¥ì„ í™•ì¥í•˜ê±°ë‚˜ ì¶”ê°€í•˜ì§€ ì•ŠëŠ”ë‹¤. ëŒ€ì‹  í´ë¼ì´ì–¸íŠ¸ê°€ íƒ€ê¹ƒì— ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì„ ë³€ê²½í•´ì¤€ë‹¤.


### ë¦¬í”Œë ‰ì…˜
> ë¦¬í”Œë ‰ì…˜ì€ ìë°”ì˜ ì½”ë“œ ìì²´ë¥¼ ì¶”ìƒí™”í•´ì„œ ì ‘ê·¼í•˜ë„ë¡ ë§Œë“  ê²ƒì´ë‹¤.


### ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œ
- ëŸ°íƒ€ì„ì‹œ í”„ë¡ì‹œ íŒ©í† ë¦¬ì— ì˜í•´ ë§Œë“¤ì–´ì§€ëŠ” ì˜¤ë¸Œì íŠ¸
- íƒ€ê²Ÿì˜ ì¸í„°í˜ì´ìŠ¤ì™€ ê°™ì€ íƒ€ì…ìœ¼ë¡œ ë§Œë“¤ì–´ì§
- í”„ë¡ì‹œë¡œì„œ í•„ìš”í•œ ë¶€ê°€ê¸°ëŠ¥ ì œê³µ ì½”ë“œëŠ” ì§ì ‘ ì‘ì„± í•„ìš”.

```java
interface Hello {
    String sayHello(String name);
    String sayHi(String name);
    String sayThankyou(String name);
}

class HelloTarget implements Hello {
    @Override
    public String sayHello(String name) {
        return "Hello " + name;
    }

    @Override
    public String sayHi(String name) {
        return "Hi " + name;
    }

    @Override
    public String sayThankYou(String name) {
        return "Thank you " + name;
    }
}

public class UpperCaseHandler implement InvocationHandler {
    Hello target;

    public UpperCaseHandler(Hello target) {
        this.target = target;
    }

    public Object invoke(Object proxy, Method method, Objects[] args) throws Throwable {
        String ret = (String) method.invoke(target, args);
        return ret.toUpperCase();
    }


}

...

Hello proxiedHello = (Hello) Proxy.newProxyInstance(
	Hello.class.getClassLoader(), // í´ë˜ìŠ¤ ë¡œë”
	new Class[]{Hello.class}, // êµ¬í˜„í•  ì¸í„°í˜ì´ìŠ¤ë“¤
	new UpperCaseHandler(new HelloTarget()) // í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ì˜ ë©”ì„œë“œ í˜¸ì¶œì„ ì²˜ë¦¬í•  InvocationHandler
);

```

- ë¬¸ì œëŠ” ì´ë ‡ê²Œ `newProxyInstance()`ë¥¼ í†µí•´ ë§Œë“¤ì–´ì§„ ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œë¥¼ ë¹ˆë“±ë¡í•´ì„œ DIë¥¼ í• ìˆ˜ ì—†ë‹¤ëŠ”ê²ƒ
- ê·¸ë˜ì„œ íŒ©í† ë¦¬ ë¹ˆì„ ì‚¬ìš©
```java

public interface FactoryBean<T> {
	T getObject() throws Exception;
	Class<? extends T> getObjectType();
	boolean isSingleton();
}
```
- ì´ ì¸í„°í˜ì´ì˜ êµ¬í˜„ì²´ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë©´ íŒ©í† ë¦¬ ë¹ˆìœ¼ë¡œ ë™ì‘í•˜ë©° getObject()ë¥¼ ë¹ˆìœ¼ë¡œ ê´€ë¦¬í•´ì¤Œ

### ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œë¥¼ ì ìš©í•œ TransactionInterceptorì˜ ë™ì‘ ë°©ì‹ ì •ë¦¬

1. **ì¸í„°ì…‰í„° êµ¬ì¡°**:
    
    - MethodInterceptor ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤.
    - AOP í”„ë¡ì‹œ ì²´ì¸ì—ì„œ ë©”ì„œë“œ í˜¸ì¶œì„ ê°€ë¡œì±„ íŠ¸ëœì­ì…˜ ë¡œì§ì„ ì¶”ê°€í•œë‹¤.
    
    ```java
    public class TransactionInterceptor extends TransactionAspectSupport implements MethodInterceptor, Serializable {
        @Override
        public Object invoke(MethodInvocation invocation) throws Throwable {
            // íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ë¡œì§
            return invokeWithinTransaction(invocation.getMethod(), invocation.getTargetClass(), invocation::proceed);
        }
    }
    ```
    
2. **invoke() ë©”ì„œë“œ**:
    
    - invoke(MethodInvocation invocation) ë©”ì„œë“œê°€ í•µì‹¬.
    - íƒ€ê²Ÿ ë©”ì„œë“œ í˜¸ì¶œì„ ê°€ë¡œì±„ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ë¡œì§ì„ ì ìš©í•œë‹¤.
3. **íŠ¸ëœì­ì…˜ ì†ì„± ê²°ì •**:
    
    - TransactionAttributeSourceë¥¼ ì‚¬ìš©í•´ ë©”ì„œë“œì— ì ìš©í•  íŠ¸ëœì­ì…˜ ì†ì„±ì„ ê²°ì •í•œë‹¤.
    - @Transactional ì• ë…¸í…Œì´ì…˜ ì„¤ì •ì—ì„œ ì†ì„±ì„ ê°€ì ¸ì˜¨ë‹¤.
    
    ```java
    TransactionAttributeSource tas = getTransactionAttributeSource();
    TransactionAttribute txAttr = tas.getTransactionAttribute(method, targetClass);
    ```
    
4. **íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ê³¼ì •**:
    
    ```java
    // invokeWithinTransaction ë©”ì„œë“œì˜ í•µì‹¬ ë¡œì§
    protected Object invokeWithinTransaction(Method method, Class<?> targetClass, InvocationCallback invocation) throws Throwable {
        // 1. íŠ¸ëœì­ì…˜ ì†ì„± ë° íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € ì¡°íšŒ
        TransactionAttributeSource tas = getTransactionAttributeSource();
        TransactionAttribute txAttr = tas.getTransactionAttribute(method, targetClass);
        PlatformTransactionManager tm = determineTransactionManager(txAttr);
        
        // 2. íŠ¸ëœì­ì…˜ ì‹œì‘
        TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, methodName);
        
        Object retVal;
        try {
            // 3. ì‹¤ì œ íƒ€ê²Ÿ ë©”ì„œë“œ í˜¸ì¶œ
            retVal = invocation.proceedWithInvocation();
        }
        catch (Throwable ex) {
            // 4. ì˜ˆì™¸ ë°œìƒ ì‹œ ë¡¤ë°± ì²˜ë¦¬
            completeTransactionAfterThrowing(txInfo, ex);
            throw ex;
        }
        finally {
            // 5. íŠ¸ëœì­ì…˜ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
            cleanupTransactionInfo(txInfo);
        }
        
        // 6. íŠ¸ëœì­ì…˜ ì»¤ë°‹
        commitTransactionAfterReturning(txInfo);
        return retVal;
    }
    ```
    
5. **íŠ¸ëœì­ì…˜ ìƒì„± ë¡œì§**:
    
    - createTransactionIfNecessary ë©”ì„œë“œëŠ” ì†ì„±ê³¼ í˜„ì¬ ìƒíƒœì— ë”°ë¼ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê±°ë‚˜ ì°¸ì—¬í•œë‹¤.
    - íŠ¸ëœì­ì…˜ ì „íŒŒ ì†ì„±ì— ë”°ë¼ ë‹¤ë¥¸ ë™ì‘ì„ ìˆ˜í–‰í•œë‹¤.
    
    ```java
    protected TransactionInfo createTransactionIfNecessary(PlatformTransactionManager tm, 
                                                          TransactionAttribute txAttr, 
                                                          String joinpointIdentification) {
        // íŠ¸ëœì­ì…˜ ìƒíƒœ ì¡°íšŒ
        TransactionStatus status = tm.getTransaction(txAttr);
        return prepareTransactionInfo(tm, txAttr, joinpointIdentification, status);
    }
    ```
    
6. **ì˜ˆì™¸ ì²˜ë¦¬ ë° ë¡¤ë°± ê²°ì •**:
    
    - completeTransactionAfterThrowing ë©”ì„œë“œë¡œ ì˜ˆì™¸ ìœ í˜•ì— ë”°ë¼ ë¡¤ë°± ì—¬ë¶€ë¥¼ ê²°ì •í•œë‹¤.
    
    ```java
    protected void completeTransactionAfterThrowing(TransactionInfo txInfo, Throwable ex) {
        if (txInfo != null && txInfo.hasTransaction()) {
            if (txInfo.transactionAttribute.rollbackOn(ex)) {
                // ë¡¤ë°± ì¡°ê±´ ë§Œì¡± ì‹œ ë¡¤ë°± ìˆ˜í–‰
                txInfo.getTransactionManager().rollback(txInfo.getTransactionStatus());
            } else {
                // ë¡¤ë°± ì¡°ê±´ ë¯¸ë§Œì¡± ì‹œ ì»¤ë°‹ ìˆ˜í–‰
                txInfo.getTransactionManager().commit(txInfo.getTransactionStatus());
            }
        }
    }
    ```
    
7. **íŠ¸ëœì­ì…˜ ì—°ê²°**:
    
    - TransactionSynchronizationManagerë¥¼ í†µí•´ íŠ¸ëœì­ì…˜ ë¦¬ì†ŒìŠ¤ë¥¼ í˜„ì¬ ì‹¤í–‰ ìŠ¤ë ˆë“œì™€ ì—°ê²°í•œë‹¤.
    
    ```java
    // DataSourceTransactionManagerì˜ ì˜ˆ
    protected void doBegin(Object transaction, TransactionDefinition definition) {
        // ì»¤ë„¥ì…˜ íšë“ ë° ì„¤ì •
        Connection con = DataSourceUtils.getConnection(dataSource);
        // íŠ¸ëœì­ì…˜ ì†ì„± ì„¤ì •
        con.setAutoCommit(false);
        // í˜„ì¬ ìŠ¤ë ˆë“œì— ë¦¬ì†ŒìŠ¤ ë°”ì¸ë”©
        TransactionSynchronizationManager.bindResource(dataSource, new ConnectionHolder(con));
        // íŠ¸ëœì­ì…˜ ë™ê¸°í™” í™œì„±í™”
        TransactionSynchronizationManager.initSynchronization();
    }
    ```
    

ì°¸ê³  : [[ìŠ¤í”„ë§-íŠ¸ëœì­ì…˜-ì •ë¦¬]]

### TLDR
1. ì»¨í…ìŠ¤íŠ¸ì—ì„œ íŠ¸ëœì­ì…˜ ê´€ë¦¬ ê¸°ëŠ¥ì´ ì¤‘ë³µë¨
2. í”„ë¡ì‹œë¥¼ í†µí•´ íŠ¸ëœì­ì…˜ ê´€ë¦¬ë¥¼ í•´ì£¼ëŠ” ë°ì½”ë ˆì´í„°ë¥¼ ì¶”ê°€
3. í•´ë‹¹ ë°ì½”ë ˆì´í„°ë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œ ê¸°ëŠ¥ì´ ìˆìŒ
4. ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œëŠ” íƒ€ê²Ÿì˜ ì¸í„°í˜ì´ìŠ¤ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë¦¬í”Œë ‰ì…˜ì„ ì´ìš©í•´ì„œ ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì†Œë“œì™€ ì•„ê·œë¨¼íŠ¸ë¥¼ ê°€ë¡œì±„ì„œ ì „ë‹¬í•´ì¤Œ
5. ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œë¥¼ ìƒì„±í•˜ë ¤ë©´ ë°ì½”ë ˆì´í„°ì— `InvocationHandler`ë¥¼ êµ¬í˜„í•´ë†”ì•¼í•˜ëŠ”ë°, ì—¬ê¸°ì„œ overrideí•˜ëŠ” invoke()ë©”ì†Œë“œëŠ” í”„ë¡ì‹œê°€ í˜¸ì¶œë˜ì—ˆì„ë•Œ, method(ë¦¬í”Œë ‰ì…˜ì˜)ì™€ argumentsë“¤ì„ ì „ë‹¬ë°›ìŒ
6. ì¦‰ êµ¬í˜„í•œ invoke()ë©”ì„œë“œ ì•ˆì—ì„œ ë°ì½”ë ˆì´íŒ… ë¡œì§ì„ ìˆ˜í–‰í•˜ê³ , íƒ€ê²Ÿì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì£¼ëŠ”ì‹
7. ê·¸ë¦¬ê³  ì´ ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œë¥¼ ë¹ˆë“±ë¡í•´ì•¼í•˜ëŠ”ë°, ê·¸ê²Œ ìƒì„±ìí†µí•´ì„œ ì˜¤ë¸Œì íŠ¸ê°€ ìƒì„±ë˜ëŠ” êµ¬ì¡°ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— FactoryBeanì„ êµ¬í˜„í•´ì„œ ë¹ˆì„ ë“±ë¡
ì¦‰ ì•„ë˜ì²˜ëŸ¼ ë“±ë¡ëœ ì„œë¹„ìŠ¤ì— íŠ¸ëœì­ì…˜ ê¸°ëŠ¥ì„ ì¼ê´„ ì ìš©í•œë‹¤ë©´
```xml
<bean id="someServiceTarget" class="complex.module.SomeServiceImpl">
	<property name="someDao" ref="someDao" />
</bean>
```
ì´ì²˜ëŸ¼ êµ¬í˜„í•´ì„œ í’€ ìˆ˜ ìˆë‹¤.
```xml
<bean id="someService" class="springprjt.service.TxProxyFactoryBean">
	<property name="target" ref="someServiceTarget" />
	<property name="transactionManager" ref="transactionManager" />
	<property name="serviceInterface" ref="complex.module.CoreService" />
</bean>
```
í”„ë¡ì‹œê°€ ì¢‹ìŒì—ë„ í”„ë¡ì‹œë¥¼ êµ¬í˜„í•˜ì§€ ì•Šì•˜ë˜ ë‘ê°€ì§€ ì´ìœ 
1. í”„ë¡ì‹œë¥¼ ì ìš©í•  ëŒ€ìƒì´ êµ¬í˜„í•˜ê³  ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ì¼ì¼íˆ ë§Œë“¤ì–´ì•¼í•¨
2. ë¶€ê°€ì ì¸ ê¸°ëŠ¥ì´ ì—¬ëŸ¬ ë©”ì†Œë“œì— ë°˜ë³µë˜ì–´ ë‚˜íƒ€ë‚˜ê²Œë¨
ì„ í•´ê²°í•œê²ƒ
- 1ë²ˆì€ ë¦¬í”Œë ‰ì…˜ ê¸°ë°˜ì˜ ë™ì  í”„ë¡ì‹œë¥¼ ì´ìš©í•´ì„œ ì¸í„°í˜ì´ìŠ¤ ì—†ì´ Methodì˜ ì¶”ìƒí™”ì™€ argumentì „ë‹¬ë“±ì„ í†µí•´
- 2ë²ˆì€ 1ë²ˆì´ ë˜ë‹ˆê¹Œ (reflectionì„ í†µí•´ íƒ€ê²Ÿ ì¸í„°í˜ì´ìŠ¤ë¥¼ ëª¨ë¥´ëŠ” ìƒíƒœë¡œ í˜¸ì¶œí•˜ëŠ”ê²Œ ë˜ë‹ˆê¹Œ) í•œë²ˆë§Œ invoke()í•´ë„ ë˜ë‹ˆê¹Œ í•´ê²°ë¨


### ê·¼ë° ë˜ í”„ë¡ì‹œ íŒ©í† ë¦¬ ë¹ˆì˜ í•œê³„
- í•˜ë‚˜ì˜ í´ë˜ìŠ¤ ì•ˆì— ì¡´ì¬í•˜ëŠ” ì—¬ëŸ¬ ê°œì˜ ë©”ì†Œë“œì— ë¶€ê°€ê¸°ëŠ¥ì„ í•œ ë²ˆì— ì œê³µí•˜ëŠ”ê±´ ì–´ë µì§€ ì•Šì§€ë§Œ, í•œë²ˆì— ì—¬ëŸ¬ê°œì˜ í´ë˜ì„œì— ê³µí†µì ì¸ ë¶€ê°€ê¸°ëŠ¥ì„ ì œê³µí•´ì•¼ í•œë‹¤ë©´?
- í•˜ë‚˜ì˜ íƒ€ê²Ÿì— ì—¬ëŸ¬ê°œ ì œê³µë„ xmlì„¤ì •ì´ ì—„ì²­ ëŠ˜ì–´ë‚œë‹¤ë©´?
- ê·¸ë¦¬ê³  TransactionHandlerê°€ ì—„ì²­ë‚˜ê²Œ ë§ì•„ì§€ëŠ” ì´ìŠˆ (ì˜¤ë¸Œì íŠ¸ ìˆ˜ê°€)

### ProxyFactoryBean
> ìë°”ì—ëŠ” jdkì—ì„œ ì œê³µí•˜ëŠ” ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œ ì™¸ì—ë„ í¸ë¦¬í•˜ê²Œ í”„ë¡ì‹œë¥¼ ë§Œë“¤ ìˆ˜ ìˆë„ë¡ ì§€ì›í•´ì£¼ëŠ” ë‹¤ì–‘í•œ ê¸°ìˆ ì´ ì¡´ì¬í•œë‹¤. ë”°ë¼ì„œ ìŠ¤í”„ë§ì€ ì¼ê´€ëœ ë°©ë²•ìœ¼ë¡œ í”„ë¡ì‹œë¥¼ ë§Œë“¤ ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” ì¶”ìƒ ë ˆì´ì–´ë¥¼ ì œê³µí•œë‹¤.

- ìŠ¤í”„ë§ì˜ ProxyFactoryBeanì€ í”„ë¡ì‹œë¥¼ ìƒì„±í•´ì„œ ë¹ˆ ì˜¤ë¸Œì íŠ¸ë¡œ ë“±ë¡í•˜ê²Œ í•´ì£¼ëŠ” íŒ©í† ë¦¬ ë¹ˆì´ë‹¤.
- ê¸°ì¡´ FactoryBeanê³¼ëŠ” ë‹¬ë¦¬ ProxyFactoryBeanì€ ìˆœìˆ˜í•˜ê²Œ í”„ë¡ì‹œë¥¼ ìƒì„±í•˜ëŠ” ì‘ì—…ë§Œì„ ë‹´ë‹¹í•˜ê³  í”„ë¡ì‹œë¥¼ í†µí•´ ì œê³µí•´ì¤„ ë¶€ê°€ê¸°ëŠ¥ì€ ë³„ë„ì˜ ë¹ˆì— ë‘˜ ìˆ˜ ìˆë‹¤.
- ê·¸ë¦¬ê³  ì—¬ê¸°ì„œ ìƒì„±í•˜ëŠ” í”„ë¡ì‹œì—ì„œ ì‚¬ìš©í•  ë¶€ê°€ê¸°ëŠ¥ì€ `MethodInterceptor`ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ì„œ ë§Œë“ ë‹¤.
- MethodInterceptorëŠ” InvocationHanlderì™€ ë¹„ìŠ·í•˜ì§€ë§Œ í•œê°€ì§€ ë‹¤ë¥¸ì ì´ ìˆëŠ”ë°, invoke()ë©”ì†Œë“œëŠ” íƒ€ê¹ƒ ì˜¤ë¸Œì íŠ¸ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤.
- ê·¸ë˜ì„œ íƒ€ê²Ÿì— ëŒ€í•œ ì •ë³´ëŠ” InvocationHanlderë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ê°€ ì§ì ‘ ì•Œê³  ìˆì–´ì•¼ í–ˆë‹¤.
- ë°˜ë©´ì— MethodInterceptorëŠ” íƒ€ê²Ÿ ì˜¤ë¸Œì íŠ¸ì˜ ì •ë³´ë„ ì œê³µë°›ëŠ”ë‹¤.
- ê·¸ë˜ì„œ íƒ€ê¹ƒ ì˜¤ë¸Œì íŠ¸ì™€ ìƒê´€ ì—†ì´ ë…ë¦½ì ìœ¼ë¡œ ë§Œë“¤ì–´ ì§ˆ ìˆ˜ ìˆê³ , íƒ€ê²Ÿì´ ë‹¤ë¥¸ ì—¬ëŸ¬ í”„ë¡ì‹œì—ì„œ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ìˆë‹¤.

### ì–´ë“œë°”ì´ìŠ¤: íƒ€ê¹ƒì´ ì—†ëŠ” ìˆœìˆ˜í•œ ë¶€ê°€ê¸°ëŠ¥
> MethodInvocationì€ ì¼ì¢…ì˜ ì½œë°± ì˜¤ë¸Œì íŠ¸ë¡œ, proceed() ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ë©´ íƒ€ê¹ƒ ì˜¤ë¸Œì íŠ¸ì˜ ë©”ì†Œë“œë¥¼ ë‚´ë¶€ì ìœ¼ë¡œ ì‹¤í–‰í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤. "ê·¸ë ‡ë‹¤ë©´ MethodInvocation êµ¬í˜„ í´ë˜ìŠ¤ëŠ” ì¼ì¢…ì˜ ê³µìœ  ê°€ëŠ¥í•œ íƒ¬í”Œë¦¿ì²˜ëŸ¼ ë™ì‘í•˜ëŠ” ê²ƒì´ë‹¤." ProxyFactoryBeanì€ ì‘ì¸ ë‹¨ìœ„ì˜ íƒ¬í”Œë¦¿/ì½œë°± êµ¬ì¡°ë¥¼ ì‘ìš©í•´ì„œ ì ìš©í–ˆê¸° ë•Œë¬¸ì— íƒ¬í”Œë¦¿ ì—­í• ì„ í•˜ëŠ” MethodInvocationì„ ì‹±ê¸€í†¤ìœ¼ë¡œ ë‘ê³  ê³µìœ í•  ìˆ˜ ìˆë‹¤. ë§ˆì¹˜ SQL íŒŒë¼ë¯¸í„° ì •ë³´ì— ì¢…ì†ë˜ì§€ ì•ŠëŠ” JdbcTemplateì´ê¸° ë•Œë¬¸ì— ìˆ˜ë§ì€ DAOë©”ì„œë“œê°€ í•˜ë‚˜ì˜ jdbcTemplate ì˜¤ë¸Œì íŠ¸ë¥¼ ê³µìœ í•  ìˆ˜ ìˆëŠ” ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ì´ë‹¤.

> MethodInterceptorì²˜ëŸ¼ íƒ€ê²Ÿ ì˜¤ë¸Œì íŠ¸ì— ì ìš©í•˜ëŠ” ë¶€ê°€ê¸°ëŠ¥ì„ ë‹´ì€ ì˜¤ë¸Œì íŠ¸ë¥¼ ìŠ¤í”„ë§ì—ì„œëŠ” ì–´ë“œë°”ì´ìŠ¤ë¼ê³  ë¶€ë¥¸ë‹¤.


### íƒ€ê²Ÿì˜ ì¸í„°í˜ì´ìŠ¤ íƒ€ì…ì„ ì œê³µë°›ì§€ ì•Šê³ ë„ ProxyFactoryBeanì€ ì–´ë–»ê²Œ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í”„ë¡ì‹œë¥¼ ë§Œë“¤ì–´ ë‚¼ ìˆ˜ ìˆì„ê¹Œ?

> ê·¸ëƒ¥ ìë™ ê²€ì¶œ ê¸°ëŠ¥ì´ ìˆìŒ.. ë­ ë¦¬í”Œë ‰ì…˜ì—ì„œ ë°›ì•„ì˜¤ê² ì§€?


### í¬ì¸íŠ¸ì»·: ë¶€ê°€ê¸°ëŠ¥ ì ìš© ëŒ€ìƒ ë©”ì„œë“œ ì„ ì • ë°©ë²•
- í…œí”Œë¦¿/ì½œë°± êµ¬ì¡°ë¥¼ ì‘ìš©í–ˆê³ , ì‹±ê¸€í†¤ ë¹ˆìœ¼ë¡œ í•´ë‘” ë•ë¶„ì— ì—¬ëŸ¬ í”„ë¡ì‹œê°€ ê³µìœ í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ëŒ€ì‹  ì–´ë–¤ ë©”ì†Œë“œê°€ í˜¸ì¶œë ì§€ì™€ ê°™ì€ êµ¬í˜„ê³¼ ê´€ë ¨í•œ ë¶€ê°€ì •ë³´ë¥¼ ë‹´ì„ìˆ˜ëŠ” ì—†ë‹¤.
- MethodInterceptorëŠ” InvocationHandlerì™€ëŠ” ë‹¤ë¥´ê²Œ í”„ë¡ì‹œê°€ í´ë¼ì–¸íŠ¸ë¡œë¶€í„° ë°›ëŠ” ìš”ì²­ì„ ì¼ì¼ì´ ì „ë‹¬ë°›ì„ í•„ìš”ëŠ” ì—†ë‹¤. MethodInterceptorì—ëŠ” ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ìˆœìˆ˜í•œ ë¶€ê°€ê¸°ëŠ¥ ì œê³µ ì½”ë“œë§Œ ë‚¨ê²¨ì£¼ëŠ” ê²ƒì´ë‹¤.
- ëŒ€ì‹  í”„ë¡ì‹œì— ë¶€ê°€ê¸°ëŠ¥ ì ìš© ë©”ì†Œë“œë¥¼ ì„ íƒí•˜ëŠ” ê¸°ëŠ¥ì„ ë„£ëŠ”ë‹¤.
- ë¬¼ë¡  í”„ë¡ì‹œì˜ í•µì‹¬ ê°€ì¹˜ëŠ” í‹°ê²Ÿì„ ëŒ€ì‹ í•´ì„œ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ì•„ ì²˜ë¦¬í•˜ëŠ” ì˜¤ë¸Œì íŠ¸ë¡œì„œì˜ ì¡´ì¬ ìì²´ì´ë¯€ë¡œ ë©”ì†Œë“œë¥¼ ì„ ë³„í•˜ëŠ” ê¸°ëŠ¥ì€ í”„ë¡ì‹œë¡œë¶€í„° ë‹¤ì‹œ ë¶„ë¦¬í•˜ëŠ” í¸ì´ ë‚«ë‹¤.
> ê¸°ì¡´ InvocationHandler ì˜¤ë¸Œì íŠ¸ëŠ”, ì˜¤ë¸Œì íŠ¸ ì°¨ì›ì—ì„œ íŠ¹ì • íƒ€ê²Ÿì„ ìœ„í•œ í”„ë¡ì‹œì— ì œí•œëœë‹¤ëŠ” ëœ»ì´ë‹¤. ê·¸ë˜ì„œ InvocationHandlerëŠ” êµ³ì´ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ëŒ€ì‹  íŒ©í† ë¦¬ ë‚´ë¶€ì—ì„œ ë§¤ë²ˆ ìƒì„±í•˜ë„ë¡ ë§Œë“¤ì—ˆë˜ ê²ƒì´ë‹¤.

> ìŠ¤í”„ë§ì€ ë¶€ê°€ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ì–´ë“œë°”ì´ìŠ¤ë¼ê³  ë¶€ë¥´ê³ , ë©”ì†Œë“œ ì„ ì • ì•Œê³ ë¦¬ì¦˜ì„ ë‹´ì€ ì˜¤ë¸Œì íŠ¸ë¥¼ í¬ì¸íŠ¸ì»·ì´ë¼ê³  ë¶€ë¥¸ë‹¤. ì–´ë“œë°”ì´ìŠ¤ì™€ í¬ì¸íŠ¸ì»·ì€ ëª¨ë‘ í”„ë¡ì‹œì— DIë¡œ ì£¼ì…ë¼ì„œ ì‚¬ìš©ëœë‹¤. ë‘ê°€ì§€ ëª¨ë‘ ì—¬ëŸ¬ í”„ë¡ì‹œì—ì„œ ê³µìœ ê°€ ê°€ëŠ¥í•˜ë„ë¡ ë§Œë“¤ì–´ì§€ê¸° ë•Œë¬¸ì— ì‹±ê¸€í†¤ ë¹ˆìœ¼ë¡œ ë“±ë¡ì´ ê°€ëŠ¥í•˜ë‹¤.

> í”„ë¡ì‹œëŠ” í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ìš”ì²­ì„ ë°›ìœ¼ë©´ ë¨¼ì € í¬ì¸íŠ¸ì»·ì—ê²Œ ë¶€ê°€ê¸°ëŠ¥ì„ ë¶€ì—¬í•  ë©”ì†Œë“œì¸ì§€ë¥¼ í™•ì¸í•´ë‹¬ë¼ê³  ìš”ì²­í•œë‹¤. í¬ì¸íŠ¸ì»·ì€ Pointcut ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì„œ ë§Œë“¤ë©´ ëœë‹¤. í”„ë¡ì‹œëŠ” í¬ì¸íŠ¸ì»·ìœ¼ë¡œë¶€í„° ë¶€ê°€ê¸°ëŠ¥ì„ ì ìš©í•  ëŒ€ìƒ ë©”ì†Œë“œì¸ì§€ í™•ì¸ ë°›ìœ¼ë©´, MethodInterceptor íƒ€ì…ì˜ ì–´ë“œë°”ì´ìŠ¤ë¥¼ í˜¸ì¶œí•œë‹¤. ì–´ë“œë°”ì´ìŠ¤ëŠ” jdkì˜ ë‹¤ì´ë‚˜ë¯¹ í”„ë¡ì‹œì²˜ëŸ¼ ì§ì ‘ íƒ€ê²Ÿì„ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ”ë‹¤. ìì‹ ì´ ê³µìœ ë¼ì•¼ í•˜ë¯€ë¡œ íƒ€ê¹ƒ ì •ë³´ë¼ëŠ” ìƒíƒœë¥¼ ê°€ì§ˆ ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ íƒ€ê²Ÿì— ì§ì ‘ ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ ì¼ì¢…ì˜ í…œí”Œë¦¿ êµ¬ì¡°ë¡œ ì„¤ê³„ë˜ì–´ ìˆë‹¤. ì–´ë“œë°”ì´ìŠ¤ê°€ ë¶€ê°€ê¸°ëŠ¥ì„ ë¶€ì—¬í•˜ëŠ” ì¤‘ì— íƒ€ê¹ƒ ë©”ì†Œë“œì˜ í˜¸ì¶œì´ í•„ìš”í•˜ë©´ í”„ë¡ì‹œë¡œë¶€í„° ì „ë‹¬ë°›ì€ MethodInvocation íƒ€ì… ì½œë°± ì˜¤ë¸Œì ë¥¼ ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

> ì‹¤ì œ ìœ„ì„ ëŒ€ìƒì¸ íƒ€ê²Ÿ ì˜¤ë¸Œì íŠ¸ì˜ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ê°–ê³  ìˆê³ , ì´ë¥¼ ì´ìš©í•´ íƒ€ê²Ÿ ë©”ì†Œë“œë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ê²ƒì€ í”„ë¡ì‹œê°€ ë©”ì†Œë“œ í˜¸ì¶œì— ë”°ë¼ ë§Œë“œëŠ” Invocation ì½œë°±ì˜ ì—­í• ì´ë‹¤.

```java
@Test
public void pointcutAdvisor() {
    ProxyFactoryBean pfBean = new ProxyFactoryBean();
    pfBean.setTarget(new HelloTarget());
    
    NameMatchPoincut poincut = new NameMatchPointCut();
    poincut.setMappedName("sayH*");

	// Pointcut Advice ê°™ì´ ì „ë‹¬
	// ì—¬ëŸ¬ í¬ì¸íŠ¸ì»·ê³¼ ì–´ë“œë°”ì´ìŠ¤ë¥¼ ë§¤í•‘í•  ìˆ˜ ìˆê¸°ì— ì´ë ‡ê²Œ ë‘ê°œ ì „ë‹¤.
	// ì–´ë“œë°”ì´ì € = í¬ì¸íŠ¸ì»· + ì–´ë“œë°”ì´ìŠ¤
    pfBean.addAdvisor(new DefaultPointcutAdvisor(pointcut, new UppercaseAdvice()));

    Hello proxiedHello = (Hello) pfBean.getObject();

    assertThat(proxiedHello.sayHello("Toby"), is("HELLO TOBY"));
    assertThat(proxiedHello.sayHello("Toby"), is("HI TOBY"));
    assertThat(proxiedHello.sayHello("Toby"), is("Thank You TOBY"));
}

```

> ì§€ê¸ˆê¹Œì§€ í•´ì™”ë˜ ì‘ì—…ì˜ ëª©í‘œëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ë°˜ë³µì ìœ¼ë¡œ ë“±ì¥í•´ì•¼ë§Œ í–ˆë˜ íŠ¸ëœì­ì…˜ ì½”ë“œë¥¼ ê¹”ë”í•˜ê³  íš¨ê³¼ì ìœ¼ë¡œ ë¶„ë¦¬í•´ë‚´ëŠ” ê²ƒì´ë‹¤. ì´ë ‡ê²Œ ë¶„ë¦¬í•´ë‚¸ íŠ¸ëœì­ì…˜ ì½”ë“œëŠ” íˆ¬ëª…í•œ ë¶€ê°€ê¸°ëŠ¥ í˜•íƒœë¡œ ì œê³µë¼ì•¼ í•œë‹¤. íˆ¬ëª…í•˜ë‹¤ëŠ”ê±´ ë¶€ê°€ê¸°ëŠ¥ì„ ì ìš©í•œ í›„ì—ë„ ê¸°ì¡´ ì„¤ê³„ì™€ ì½”ë“œì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ»ì´ë‹¤/


### ë¹ˆ í›„ì²˜ë¦¬ê¸°ë¥¼ ì´ìš©í•œ ìë™ í”„ë¡ì‹œ ìƒì„±ê¸°
- ìŠ¤í”„ë§ ë¹ˆ ì˜¤ë¸Œì íŠ¸ë¡œ ë§Œë“¤ì–´ì§€ê³  ë‚œ ì´í›„ì— ì˜¤ë¸Œì íŠ¸ë¥¼ ë‹¤ì‹œ ê°€ê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤
- DafaultAdvisorAutoProxyCreator : ìë™ í”„ë¡ì‹œ ìƒì„±ê¸° -> ë¹ˆì„ ë§Œë“¤ë•Œë§ˆë‹¤ í›„ì²˜ë¦¬ê¸°ë¡œ ë³´ë‚´ê³ , ì—¬ê¸°ì„œ ëª¨ë“  ì–´ë“œìì´ì € ë‚´ì˜ í¬ì¸íŠ¸ì»·ì„ ë’¤ì§€ê³  ëŒ€ìƒì´ë¼ë©´ ê·¸ë•Œ í”„ë¡ì‹œë¥¼ ë§Œë“¤ì–´ ì–´ë“œë°”ì´ì €ë¥¼ ì—°ê²°í•´ì¤€ë‹¤.
- ì´ê±´ ì•„ë˜ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯, Pointcutì´ í´ë˜ìŠ¤í•„í„°ì™€ ë©”ì†Œë“œ ë§¤ì²˜ ë‘ê°€ì§€ë¥¼ ëŒë ¤ì£¼ëŠ” ë©”ì†Œë“œë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•˜ë‹¤.
```java
public interface Pointcut {
	ClassFilter getClassFilter(); // í”„ë¡ì‹œë¥¼ ì ìš©í•  í´ë˜ìŠ¤ì¸ì§€ í™•ì¸
	MethodMatcher getMethodMatcher(); // ì–´ë“œë°”ì´ìŠ¤ë¥¼ ì ìš©í•  ë©”ì†Œë“œì¸ì§€ í™•ì¸
}
```

> Aspectë€ ê·¸ ìì²´ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ ê¸°ëŠ¥ì„ ë‹´ê³  ìˆì§€ëŠ” ì•Šì§€ë§Œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•˜ëŠ” ì¤‘ìš”í•œ í•œ ê°€ì§€ ìš”ì†Œì´ê³ , í•µì‹¬ ê¸°ëŠ¥ì— ë¶€ê°€ë˜ì–´ ì˜ë¯¸ë¥¼ ê°–ëŠ” íŠ¹ë³„í•œ ëª¨ë“ˆ

### AOP ìš©ì–´ ì •ë¦¬
- íƒ€ê²Ÿ : ë¶€ê°€ê¸°ëŠ¥ì„ ë¶€ì—¬í•  ëŒ€ìƒ, í•µì‹¬ê¸°ëŠ¥ì„ ë‹´ì€ í´ë˜ìŠ¤ì¼ ìˆ˜ ìˆì§€ë§Œ ê²½ìš°ì— ë”°ë¼ì„œëŠ” ë‹¤ë¥¸ ë¶€ê°€ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë˜ë‹¤ë¥¸ í”„ë¡ì‹œ ì¼ ìˆ˜ ìˆìŒ
- ì–´ë“œë°”ì´ìŠ¤ : íƒ€ê²Ÿì— ì œê³µí•  ë¶€ê°€ê¸°ëŠ¥ì„ ë‹´ì€ ëª¨ë“ˆ, ë©”ì†Œë“œ ë ˆë²¨ì˜ ì •ì˜ë„ ê°€ëŠ¥í•¨, í˜¸ì¶œ ê³¼ì • ì „ë°˜ì— ì°¸ì—¬í• ìˆ˜ë„ìˆì§€ë§Œ ì˜ˆì™¸ê°€ ë™ì‘í• ë•Œë§Œ ë™ì‘í•˜ëŠ” ì–´ë“œë°”ì´ìŠ¤ì²˜ëŸ¼ í˜¸ì¶œ ê³¼ì •ì˜ ì¼ë¶€ì—ë§Œ ë™ì‘í• ìˆ˜ë„ ìˆìŒ
- ì¡°ì¸ í¬ì¸íŠ¸ : ì–´ë“œë°”ì´ìŠ¤ê°€ ì ìš©ë  ìˆ˜ ìˆëŠ” ìœ„ì¹˜
- í¬ì¸íŠ¸ì»· : ì–´ë“œë°”ì´ìŠ¤ë¥¼ ì ìš©í•  ì¡°ì¸ í¬ì¸íŠ¸ë¥¼ ì„ ë³„í•˜ëŠ” ì‘ì—… ë˜ëŠ” ê·¸ ê¸°ëŠ¥ì„ ì •ì˜í•œ ëª¨ë“ˆ
- í”„ë¡ì‹œ : í´ë¼ì´ì–¸íŠ¸ì™€ íƒ€ê²Ÿ ì‚¬ì´ì— íˆ¬ëª…í•˜ê²Œ ì¡´ì¬í•˜ë©´ì„œ ë¶€ê°€ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì˜¤ë¸Œì íŠ¸
- ì–´ë“œë°”ì´ì €: í¬ì¸íŠ¸ì»·ê³¼ ì–´ë“œë°”ì´ìŠ¤ë¥¼ í•˜ë‚˜ì”© ê°€ì§€ê³  ìˆëŠ” ì˜¤ë¸Œì íŠ¸, ì–´ë–¤ ë¶€ê°€ê¸°ëŠ¥ì„ ì–´ë””ì— ì „ë‹¬í•  ê²ƒì¸ê°€ë¥¼ ì•Œê³ ìˆëŠ” ê°€ì¥ ê¸°ë³¸ ëª¨ë“ˆ


### í”„ë¡ì‹œ ë°©ì‹ aopëŠ” ê°™ì€ íƒ€ê²Ÿ ì˜¤ë¸Œì­íŠ¸ ë‚´ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•  ë•ŒëŠ” ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤
- í´ë¼ì´ì–¸íŠ¸ê°€ í˜¸ì¶œí•˜ë©´ í”„ë¡ì‹œê°€ í˜¸ì¶œë˜ê³  íŠ¸ëœì­ì…˜ í”„ë¡ì‹œë¥¼ íƒ€ê²Œëœë‹¤,
- ë‹¤ë§Œ íƒ€ê²Ÿ ì˜¤ë¸Œì íŠ¸ ë‚´ì—ì„œ ë‹¤ë¥¸ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ì—ëŠ” ì§ì ‘ í˜¸ì¶œëœë‹¤.
> ê¸°ê»í•´ì•¼ getìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë©”ì„œë“œì— ì½ê¸°ì „ìš© ì†ì„±ì„ ë¶€ì—¬í•˜ê³  REQUIREDì „íŒŒ ì†ì„±ì„ ì‚¬ìš©í•˜ëŠ” ì •ë„ì—ëŠ” ë¬´ì‹œí•´ë„ ëœë‹¤. ë‹¤ë§Œ ë³µì¡í•œ íŠ¸ëœì­ì…˜ ì „íŒŒì†ì„±ì„ ì ìš©í•´ì•¼í•˜ëŠ” ê²½ìš°ëŠ” ì£¼ì˜ê°€ í•„ìš”í•˜ë‹¤.
- ì½ê¸°ì „ìš© ì†ì„±ì€ ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”ë¥¼ ìœ„í•œ íŒíŠ¸ì¼ ë¿ì´ë‹¤.
- REQUIRED ì „íŒŒ ì†ì„±ì€ ì´ë¯¸ íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©í•˜ë¯€ë¡œ ë‚´ë¶€ í˜¸ì¶œì—ë„ íŠ¸ëœì­ì…˜ ì»¨í…ìŠ¤íŠ¸ê°€ ìœ ì§€ëœë‹¤.
- í•´ê²°ë°©ë²•ì€ ë‘ê°€ì§€ì´ë‹¤.
	- Aspectj ì‚¬ìš©
	- ìŠ¤í”„ë§ APIë¥¼ ì´ìš©í•´ í”„ë¡ì‹œ ì˜¤ë¸Œì íŠ¸ì— ëŒ€í•œ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ê°€ì ¸ì˜¨ ë’¤ì— ê°™ì€ ì˜¤ë¸Œì íŠ¸ì˜ ë©”ì†Œë“œ í˜¸ì¶œë„ í”„ë¡ì‹œë¥¼ íƒ€ê²Œ ê°•ì œí•˜ëŠ” ë°©ë²• -> ê¶Œì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.

### Transactional ì–´ë…¸í…Œì´ì…˜
```java
@Target({ElementType.METHOD, ElementType.TYPE}) // ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš© ëŒ€ìƒ
@Retention(RetentionPolicy.RUNTIME) // ì–´ë…¸í…Œì´ì…˜ ì •ë³´ ìœ ì§€ ê¸°í•œ
@Inherited // ìƒì†í•´ë„ ê°€ëŠ¥í•˜ë„ë¡
@Documented
public @interface Transactional {
    String value() default "";
    Propagation propagation() default Propagation.REQUIRED;
    Isolation isolation() default Isolation.Default;
    ...
}

```

## ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°

### ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì—”í‹°í‹°ê´€ë¦¬í•˜ëŠ” ì¥ì 
- 1ì°¨ ìºì‹œ : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ìºì‹œëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìºì‹œí•˜ë¯€ë¡œ ë™ì¼ì„±ì´ ë³´ì¥ë¨ + ì–´í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì˜ REPEATABLE READ
- ë™ì¼ì„± ë³´ì¥
- íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°
- ë³€ê²½ ê°ì§€
- ì§€ì—° ë¡œë”©
> ê²°ë¡ ì ìœ¼ë¡œ ê·¸ëƒ¥ db ioë¥¼ ì¤„ì—¬ì¤Œ, jpa, hibernate í¬ê²ŒëŠ” ormì˜ ë…ìì ì¸ ì¥ì ìœ¼ë¡œ ë³´ê¸°ëŠ” ì–´ë µì§€ë§Œ ìƒíƒœê³„ê°€ ì´ìª½ìœ¼ë¡œ ë°œì „í–ˆê¸° ë•Œë¬¸ì— ì´ë§Œí¼ í•´ì£¼ëŠ”ê²Œ ì—†ì§€ì•Šë‚˜ ì‹¶ìŒ, ë‚œì´ë„ë‚˜ ê³µìˆ˜ê°€ ì˜¬ë¼ê°€ê±°ë‚˜

### jpa ìˆ˜ì •
- `@org.hibernate.annotations.DynamicUpdate` : íŠ¹ì • ì¹¼ëŸ¼ë§Œ ì—…ë°ì´íŠ¸ í•˜ëŠ” updateì¿¼ë¦¬ë¥¼ ì‘ì„±í•´ì¤Œ, ì˜¤ë²„í—¤ë“œë¥¼ ë”°ì ¸ë´¤ì„ë•Œ ì¹¼ëŸ¼ 30ê°œì´ìƒì€ ë˜ì–´ì•¼ ìœ ì˜ë¯¸í•œê²ƒê°™ìŒ


[[ì–‘ë°©í–¥-ìˆœí™˜ì°¸ì¡°]]

### í”„ë¡ì‹œì™€ ì§€ì—°ë¡œë”©
```java
// ë‚´ë¶€ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” í”„ë¡ì‹œ í´ë˜ìŠ¤ì˜ ì´ë¡ ì  êµ¬ì¡°
public class MemberProxy extends Member {
    private Member target = null;
    
    @Override
    public String getName() {
        if (target == null) {
            // ì´ˆê¸°í™” ìš”ì²­
            initializeTarget();
        }
        return target.getName();
    }
    
    private void initializeTarget() {
        // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í†µí•´ ì‹¤ì œ ì—”í‹°í‹° ë¡œë”©
        // target í•„ë“œì— í• ë‹¹
    }
}
```
> ìœ„ëŠ” ì´ë¡ ì  êµ¬ì¡°ì´ê³ , ì‹¤ì œëŠ” ìë°” ë°”ì´íŠ¸ì½”ë“œ ì¡°ì‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ì„œ ì²˜ë¦¬ë¨

- ì»¬ë ‰ì…˜ì„ í•˜ë‚˜ ì´ìƒ ì¦‰ì‹œ ë¡œë”©í•˜ëŠ”ê²ƒì€ ê¶Œì¥í•˜ì§€ ì•ŠìŒ, ì»¬ë ‰ì…˜ê³¼ ì¡°ì¸í•œë‹¤ëŠ”ê²ƒì€ ì¼ëŒ€ë‹¤ ì¡°ì¸ìœ¼ë¡œ ì´ë¤„ì§€ëŠ”ë° n x m ì¡°ì¸ì´ ì´ë£¨ì–´ì§€ëŠ”ê²½ìš°ê°€ ìƒê¹€
- ê·¸ë¦¬ê³  ì™¸ë¶€ì¡°ì¸ìœ¼ë¡œ ì‚¬ìš©ë˜ê¸°ë•Œë¬¸ì— ë”ë”ìš± ì•ˆë¨

### ì»¬ë ‰ì…˜ ì¦‰ì‹œ ë¡œë”©(EAGER)ì˜ ë¬¸ì œì 

1. **ì¹´í…Œì‹œì•ˆ ê³±(Cartesian Product) ë¬¸ì œ**
    - ì—¬ëŸ¬ ì»¬ë ‰ì…˜ì„ ì¦‰ì‹œ ë¡œë”©í•˜ë©´ SQL JOINì—ì„œ N Ã— M ê°œì˜ ê²°ê³¼ í–‰ì´ ë°œìƒí•¨
    - ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë¶ˆí•„ìš”í•œ ë°ì´í„°ê°€ ë¡œë“œë˜ì–´ ì„±ëŠ¥ê³¼ ë©”ëª¨ë¦¬ì— ì‹¬ê°í•œ ì˜í–¥ì„ ë¯¸ì¹¨
2. **ì™¸ë¶€ ì¡°ì¸(OUTER JOIN) ì‚¬ìš©**
    - JPAëŠ” ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì™¸ë¶€ ì¡°ì¸ì„ ì‚¬ìš©í•¨
    - ì—¬ëŸ¬ ì™¸ë¶€ ì¡°ì¸ì€ ì¿¼ë¦¬ ì„±ëŠ¥ì„ ë”ìš± ì €í•˜ì‹œí‚´

#### ì—”í‹°í‹° í´ë˜ìŠ¤
```java
@Entity
public class User {
    @Id @GeneratedValue
    private Long id;
    private String name;
    
    @OneToMany(mappedBy = "user", fetch = FetchType.EAGER)
    private List<Order> orders = new ArrayList<>();
    
    @OneToMany(mappedBy = "user", fetch = FetchType.EAGER)
    private List<Post> posts = new ArrayList<>();
}

@Entity
public class Order {
    @Id @GeneratedValue
    private Long id;
    private String orderNumber;
    
    @ManyToOne
    private User user;
}

@Entity
public class Post {
    @Id @GeneratedValue
    private Long id;
    private String title;
    
    @ManyToOne
    private User user;
}
```
#### ìƒ˜í”Œ ë°ì´í„°

**User í…Œì´ë¸”**:

| id  | name  |
| --- | ----- |
| 1   | Alice |
| 2   | Bob   |

**Order í…Œì´ë¸”**:

|id|order_number|user_id|
|---|---|---|
|1|ORD-001|1|
|2|ORD-002|1|
|3|ORD-003|2|

**Post í…Œì´ë¸”**:

|id|title|user_id|
|---|---|---|
|1|First Post|1|
|2|Second Post|1|
|3|Hello World|2|
|4|My Story|2|

#### ìƒì„±ë˜ëŠ” SQL ì˜ˆì‹œ
```sql
SELECT u.*, o.*, p.*
FROM User u
LEFT OUTER JOIN Order o ON u.id = o.user_id
LEFT OUTER JOIN Post p ON u.id = p.user_id
```

### ê²°ê³¼ (N Ã— M ë¬¸ì œ)

|u.id|u.name|o.id|o.order_number|o.user_id|p.id|p.title|p.user_id|
|---|---|---|---|---|---|---|---|
|1|Alice|1|ORD-001|1|1|First Post|1|
|1|Alice|1|ORD-001|1|2|Second Post|1|
|1|Alice|2|ORD-002|1|1|First Post|1|
|1|Alice|2|ORD-002|1|2|Second Post|1|
|2|Bob|3|ORD-003|2|3|Hello World|2|
|2|Bob|3|ORD-003|2|4|My Story|2|

**ë¬¸ì œì  ì„¤ëª…**:
- User 'Alice'ê°€ 2ê°œì˜ ì£¼ë¬¸ê³¼ 2ê°œì˜ ê²Œì‹œë¬¼ì„ ê°€ì§€ê³  ìˆì–´ 4ê°œì˜ í–‰ì´ ìƒì„±ë¨(2Ã—2=4)
- User 'Bob'ì´ 1ê°œì˜ ì£¼ë¬¸ê³¼ 2ê°œì˜ ê²Œì‹œë¬¼ì„ ê°€ì§€ê³  ìˆì–´ 2ê°œì˜ í–‰ì´ ìƒì„±ë¨(1Ã—2=2)
- ì›ë˜ UserëŠ” 2ëª…ì´ì§€ë§Œ, ê²°ê³¼ í–‰ì€ ì´ 6ê°œë¡œ ì¦ê°€í•¨
- ë°ì´í„°ê°€ ë¶ˆí•„ìš”í•˜ê²Œ ì¤‘ë³µë˜ì–´ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¦ê°€ ë° ì„±ëŠ¥ ì €í•˜

#### ëŒ€ì•ˆ

- **ì§€ì—° ë¡œë”©(LAZY) ì‚¬ìš©**
	- ì»¬ë ‰ì…˜ì€ í•­ìƒ ì§€ì—° ë¡œë”©ìœ¼ë¡œ ì„¤ì •í•˜ê³  í•„ìš”í•  ë•Œë§Œ ë¡œë”©
- **í˜ì¹˜ ì¡°ì¸(Fetch Join) ì‚¬ìš©**
```java
// í•„ìš”í•œ ì»¬ë ‰ì…˜ë§Œ ì„ íƒì ìœ¼ë¡œ ë¡œë”©
String jpql = "SELECT u FROM User u JOIN FETCH u.orders WHERE u.id = :id";
User user = em.createQuery(jpql, User.class)
              .setParameter("id", userId)
              .getSingleResult();
```
    
- **@EntityGraph ì‚¬ìš©**
```java
@EntityGraph(attributePaths = {"orders"})
@Query("SELECT u FROM User u WHERE u.id = :id")
User findUserWithOrders(@Param("id") Long id);
```
    
- **DTO ì‚¬ìš©**
```java
@Query("SELECT new com.example.UserOrderDTO(u.id, u.name, o.id, o.orderNumber) " + "FROM User u JOIN u.orders o WHERE u.id = :id") List<UserOrderDTO> findUserOrderDTOs(@Param("id") Long id);
```

- **ë°°ì¹˜ ì‚¬ì´ì¦ˆ ì¡°ì • (@BatchSize)**
```java
@OneToMany(mappedBy = "user", fetch = FetchType.LAZY)
@BatchSize(size = 100)
private List<Order> orders = new ArrayList<>();
```
- N+1 ë¬¸ì œëŠ” ì—¬ì „íˆ ë°œìƒí•˜ì§€ë§Œ, IN ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•´ í•œ ë²ˆì— ì—¬ëŸ¬ ì»¬ë ‰ì…˜ì„ ë¡œë”©í•˜ë„ë¡ ìµœì í™”


### ì˜ì†ì„±ì „ì´ì™€ ê³ ì•„ê°ì²´

#### ì˜ì†ì„± ì „ì´
- ë¶€ëª¨ ì—”í‹°í‹°ì˜ ì˜ì†ì„± ìƒíƒœ ë³€í™”ê°€ ìì‹ ì—”í‹°í‹°ì—ê²Œë„ ì „ì´ë˜ëŠ” ê¸°ëŠ¥
- ì˜ˆë¥¼ ë“¤ì–´ ë¶€ëª¨ë¥¼ persist(), remove() í•˜ë©´ ìì‹ë„ ê°™ì´ persist(), remove() ë¨
- ì£¼ë¡œ @OneToMany, @ManyToOne, @OneToOne ê´€ê³„ì—ì„œ ì‚¬ìš©

| **ì˜µì…˜**  | **ì„¤ëª…**                   |
| ------- | ------------------------ |
| PERSIST | ë¶€ëª¨ ì €ì¥ ì‹œ ìì‹ë„ ì €ì¥           |
| REMOVE  | ë¶€ëª¨ ì‚­ì œ ì‹œ ìì‹ë„ ì‚­ì œ           |
| MERGE   | ë¶€ëª¨ ê°±ì‹  ì‹œ ìì‹ë„ ê°±ì‹            |
| DETACH  | ë¶€ëª¨ detach ì‹œ ìì‹ë„ detach   |
| REFRESH | ë¶€ëª¨ refresh ì‹œ ìì‹ë„ refresh |
| ALL     | ìœ„ì˜ ëª¨ë“  ê¸°ëŠ¥ í¬í•¨              |
#### ê³ ì•„ê°ì²´
- ë¶€ëª¨ì™€ì˜ ê´€ê³„ê°€ ëŠì–´ì§„(ì—°ê´€ê´€ê³„ê°€ ì œê±°ëœ) ìì‹ ì—”í‹°í‹°ë¥¼ ìë™ìœ¼ë¡œ remove() ì²˜ë¦¬í•˜ëŠ” ê¸°ëŠ¥
- ë¬¼ë¦¬ì ìœ¼ë¡œ DBì—ì„œ ìì‹ rowë¥¼ ì‚­ì œí•¨
- orphanRemoval = true ë¡œ ì„¤ì •

**ë™ì‘ ì¡°ê±´**
- ìì‹ì´ ë¶€ëª¨ ì»¬ë ‰ì…˜ì—ì„œ ì œê±°ë˜ê±°ë‚˜, ë¶€ëª¨ ì—”í‹°í‹°ì™€ì˜ ì—°ê´€ê´€ê³„ê°€ ëŠì–´ì§ˆ ë•Œ
- ë³´í†µ ì •ë§ ëª…í™•í•˜ë©´ : **CascadeType.ALL + orphanRemoval = true**
- ì• ë§¤í•˜ë©´ : **CascadeType.PERSIST**
